<%= form_with(model: compra, local: true, :class => 'form-floating') do |form| %>
  <% if compra.errors.any? %>
    <div id="error_explanation">
      <div class="alert alert-danger"><%= pluralize(compra.errors.count, "erros") %> impediram que este fornecedor fosse salvo:
				<ul>
					<% compra.errors.full_messages.each do |message| %>
						<li><%= message %></li>
					<% end %>
				</ul>
			</div>
    </div>
  <% end %>
	<div class="row">
	  <div class="col-md-6">
	    <div class="form-floating mb-3">
	      <%= form.date_field :data, {class: "form-control"} %>
	      <%= form.label :data %>
	    </div>
	  </div>
	  <div class="col-md-6">
	    <div class="form-floating mb-3">
	    <%= form.number_field :valor_total, {class: "form-control", min: "0.00", max: "999999.00", step: "0.01"} %>
	    <%= form.label :valor_total %>
	    </div>
	  </div>
	</div>
	<div class="row">
	  <div class="col-md-12">
	    <div class="form-floating mb-3">
				<div class="clear" id="nome_<%= form_tag_id(form.object_name, :fornecedor_id) %>">
	      	<%= form.label :fornecedor %>
					<%= autocomplete_field :fornecedor, :nome,
						autocomplete_fornecedor_nome_acs_path,
						:update_elements => { :id => "#"+ form_tag_id(form.object_name, :fornecedor_id) },
						:class => "form-control",
						:id_element => "#"+ form_tag_id(form.object_name, :fornecedor_id),
						:value => form.object.fornecedor.try(:nome) %>
					<%= form.hidden_field :fornecedor_id %>
				</div>
	    </div>
	  </div>
	</div>
	<div class="row">
	  <div class="col-md-12">
	    <div class="form-floating mb-3">
	      <%= form.text_area :observacao, {class: "form-control"} %>
	      <%= form.label :observacao %>
	    </div>
	  </div>
	</div>
	<div class="row">
		<div class="col-md-12">
			<ul class="nav nav-tabs" id="myTab" role="tablist">
				<li class="nav-item" role="presentation">
					<button class="nav-link active" id="produtos-tab" data-bs-toggle="tab" data-bs-target="#produtos-tab-pane" type="button" role="tab" aria-controls="produtos-tab-pane" aria-selected="true">Produtos</button>
				</li>
				<li class="nav-item" role="presentation">
					<button class="nav-link" id="pagamento-tab" data-bs-toggle="tab" data-bs-target="#pagamento-tab-pane" type="button" role="tab" aria-controls="pagamento-tab-pane" aria-selected="false">Pagamento</button>
				</li>
			</ul>
			<div class="tab-content" id="myTabContent">
				<div class="tab-pane fade show active" id="produtos-tab-pane" role="tabpanel" aria-labelledby="produtos-tab" tabindex="0">
					<div class="row">
						<h5 class="mt-3 mb-3">Lan√ßamento de produtos</h5>
						<div id="compra_itens">
							<%= form.fields_for :compra_itens do |compra_item| %>
								<%= render 'compra_item_fields', f: compra_item %>
							<% end %>
							<div class="links">
								<%= link_to_add_association "+ Adicionar produto", form, :compra_itens, class: "badge bg-primary mb-2" %>
							</div>
						</div>
					</div>
				</div>
				<div class="tab-pane fade" id="pagamento-tab-pane" role="tabpanel" aria-labelledby="pagamento-tab" tabindex="0">
					<div class="row">
						<h5 class="mt-3 mb-3">Forma de pagamento</h5>
						<div id="compras_a_pagar">
							<%= form.fields_for :compras_a_pagar do |compra_a_pagar| %>
								<%= render 'compra_a_pagar_fields', f: compra_a_pagar %>
							<% end %>
							<div class="links">
								<%= link_to_add_association "+ Adicionar parcela", form, :compras_a_pagar, class: "badge bg-primary mb-2" %>
							</div>
						</div>
					</div>	
				</div>
			</div>
		</div>
	</div>
	<div class="row">
	  <div class="actions pt-2 mb-2">
			<hr>
			<%= link_to 'Voltar', compras_path, class: "btn btn-secondary text-white" %>
	    <%= form.submit(:class => 'btn btn-success') %>
	  </div>
	</div>
<% end %>